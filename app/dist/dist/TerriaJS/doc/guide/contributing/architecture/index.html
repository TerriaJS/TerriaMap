



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.2.3">
    
    
      
        <title>Architecture - TerriaJS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.bcabdff3.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="TerriaJS" class="md-header-nav__button md-logo">
          
            <img src="../../terria.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                TerriaJS
              </span>
              <span class="md-header-nav__topic">
                Architecture
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../terria.png" width="24" height="24">
      
    </span>
    TerriaJS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Customizing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Customizing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../customizing/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../customizing/client-side-config/" title="Client-side Config" class="md-nav__link">
      Client-side Config
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../customizing/initialization-files/" title="Initialization Files" class="md-nav__link">
      Initialization Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../customizing/server-side-config/" title="Server-side Config" class="md-nav__link">
      Server-side Config
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../customizing/skinning/" title="Skinning" class="md-nav__link">
      Skinning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Connecting to Data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Connecting to Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/cross-origin-resource-sharing/" title="Cross-Origin Resource Sharing" class="md-nav__link">
      Cross-Origin Resource Sharing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-groups/" title="Catalog Groups" class="md-nav__link">
      Catalog Groups
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-items/" title="Catalog Items" class="md-nav__link">
      Catalog Items
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      Customizing Data Appearance
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        Customizing Data Appearance
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/customizing-data-appearance/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/customizing-data-appearance/imagery-data/" title="Imagery Data" class="md-nav__link">
      Imagery Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/customizing-data-appearance/tabular-data/" title="Tabular Data" class="md-nav__link">
      Tabular Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/customizing-data-appearance/feature-info-template/" title="Feature Information Template" class="md-nav__link">
      Feature Information Template
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-functions/" title="Catalog Functions" class="md-nav__link">
      Catalog Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      Catalog Type Details
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        Catalog Type Details
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/abs-itt-dataset-list/" title="ABS ITT (group)" class="md-nav__link">
      ABS ITT (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/abs-itt/" title="ABS ITT (item)" class="md-nav__link">
      ABS ITT (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/esri-featureServer-group/" title="ArcGIS FeatureServer (group)" class="md-nav__link">
      ArcGIS FeatureServer (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/esri-featureServer/" title="ArcGIS FeatureServer (item)" class="md-nav__link">
      ArcGIS FeatureServer (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/esri-mapServer-group/" title="ArcGIS MapServer (group)" class="md-nav__link">
      ArcGIS MapServer (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/esri-mapServer/" title="ArcGIS MapServer (item)" class="md-nav__link">
      ArcGIS MapServer (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/esri-group/" title="ArcGIS Server (group)" class="md-nav__link">
      ArcGIS Server (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/bing-maps/" title="Bing Maps (item)" class="md-nav__link">
      Bing Maps (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/carto/" title="Carto Map (item)" class="md-nav__link">
      Carto Map (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/csw/" title="Catalog Service for the Web (CSW) (group)" class="md-nav__link">
      Catalog Service for the Web (CSW) (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/3d-tiles/" title="Cesium 3D Tiles (item)" class="md-nav__link">
      Cesium 3D Tiles (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/ion-imagery/" title="Cesium Ion Imagery (item)" class="md-nav__link">
      Cesium Ion Imagery (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/czml/" title="Cesium Language (CZML) (item)" class="md-nav__link">
      Cesium Language (CZML) (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/cesium-terrain/" title="Cesium Terrain (item)" class="md-nav__link">
      Cesium Terrain (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/ckan/" title="CKAN (group)" class="md-nav__link">
      CKAN (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/ckan-resource/" title="CKAN Resource (item)" class="md-nav__link">
      CKAN Resource (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/csv/" title="Comma-Separated Values (CSV) (item)" class="md-nav__link">
      Comma-Separated Values (CSV) (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/composite/" title="Composite (item)" class="md-nav__link">
      Composite (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/ogr/" title="Format Conversion Service (based on OGR) (item)" class="md-nav__link">
      Format Conversion Service (based on OGR) (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/geojson/" title="GeoJSON (item)" class="md-nav__link">
      GeoJSON (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/gpx/" title="GPX (item)" class="md-nav__link">
      GPX (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/group/" title="Group (Manual) (group)" class="md-nav__link">
      Group (Manual) (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/kml/" title="Keyhole Markup Language (KML) (item)" class="md-nav__link">
      Keyhole Markup Language (KML) (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/magda-distribution/" title="MAGDA Distribution (item)" class="md-nav__link">
      MAGDA Distribution (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/mapbox-map/" title="MapBox Map (item)" class="md-nav__link">
      MapBox Map (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/open-street-map/" title="OpenStreetMap (item)" class="md-nav__link">
      OpenStreetMap (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/places-like-me-function/" title="Places Like Me (function)" class="md-nav__link">
      Places Like Me (function)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/sdmx-json/" title="SDMX-JSON (item)" class="md-nav__link">
      SDMX-JSON (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/sos/" title="Sensor Observation Service (SOS) (item)" class="md-nav__link">
      Sensor Observation Service (SOS) (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/socrata/" title="Socrata (group)" class="md-nav__link">
      Socrata (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/spatial-detailing-function/" title="Spatial Detailing (function)" class="md-nav__link">
      Spatial Detailing (function)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/terria-json/" title="TerriaJS JSON (function)" class="md-nav__link">
      TerriaJS JSON (function)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/url-template/" title="URL Template (item)" class="md-nav__link">
      URL Template (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/wfs-getCapabilities/" title="Web Feature Service (WFS) (group)" class="md-nav__link">
      Web Feature Service (WFS) (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/wfs/" title="Web Feature Service (WFS) (item)" class="md-nav__link">
      Web Feature Service (WFS) (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/wms-getCapabilities/" title="Web Map Service (WMS) (group)" class="md-nav__link">
      Web Map Service (WMS) (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/wms/" title="Web Map Service (WMS) (item)" class="md-nav__link">
      Web Map Service (WMS) (item)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/wps/" title="Web Processing Service (WPS) (function)" class="md-nav__link">
      Web Processing Service (WPS) (function)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/wps-getCapabilities/" title="Web Processing Service (WPS) (group)" class="md-nav__link">
      Web Processing Service (WPS) (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/wfs-features-group/" title="WFS Features (group)" class="md-nav__link">
      WFS Features (group)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting-to-data/catalog-type-details/why-am-i-special-function/" title="Why Am I Special (function)" class="md-nav__link">
      Why Am I Special (function)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Deploying
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Deploying
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/deploying-terriamap/" title="Deploying TerriaMap" class="md-nav__link">
      Deploying TerriaMap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/deploying-to-aws/" title="Deploying to AWS" class="md-nav__link">
      Deploying to AWS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/deploying-with-kubernetes/" title="Deploying with Kubernetes" class="md-nav__link">
      Deploying with Kubernetes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/setting-up-a-region-mapping-server/" title="Setting Up a Region Mapping Server" class="md-nav__link">
      Setting Up a Region Mapping Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/setting-up-geoserver/" title="Setting Up Geoserver" class="md-nav__link">
      Setting Up Geoserver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/using-as-a-ckan-previewer/" title="Using as a CKAN Previewer" class="md-nav__link">
      Using as a CKAN Previewer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/controlling-with-url-parameters/" title="Controlling with URL Parameters" class="md-nav__link">
      Controlling with URL Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploying/controlling-in-an-iframe-or-popup/" title="Controlling in an &lt;iframe&gt; or Popup" class="md-nav__link">
      Controlling in an &lt;iframe&gt; or Popup
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Contributing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Contributing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../development-environment/" title="Development Environment" class="md-nav__link">
      Development Environment
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Architecture
      </label>
    
    <a href="./" title="Architecture" class="md-nav__link md-nav__link--active">
      Architecture
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#layers" title="Layers" class="md-nav__link">
    Layers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-interface" title="User interface" class="md-nav__link">
    User interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observables-and-observemodelmixin" title="Observables and ObserveModelMixin" class="md-nav__link">
    Observables and ObserveModelMixin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#major-components-in-models" title="Major Components in Models" class="md-nav__link">
    Major Components in Models
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terria" title="Terria" class="md-nav__link">
    Terria
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalog" title="Catalog" class="md-nav__link">
    Catalog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nowviewing" title="NowViewing" class="md-nav__link">
    NowViewing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalogmember" title="CatalogMember" class="md-nav__link">
    CatalogMember
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cataloggroup" title="CatalogGroup" class="md-nav__link">
    CatalogGroup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalogitem" title="CatalogItem" class="md-nav__link">
    CatalogItem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalogfunction" title="CatalogFunction" class="md-nav__link">
    CatalogFunction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#globeormap" title="GlobeOrMap" class="md-nav__link">
    GlobeOrMap
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapping" title="Mapping" class="md-nav__link">
    Mapping
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-architecture" title="Build Architecture" class="md-nav__link">
    Build Architecture
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../using-a-custom-version-of-cesium/" title="Using a Custom Version of Cesium" class="md-nav__link">
      Using a Custom Version of Cesium
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../setting-up-saucelabs/" title="Setting up Saucelabs" class="md-nav__link">
      Setting up Saucelabs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../problems-and-solutions/" title="Problems and Solutions" class="md-nav__link">
      Problems and Solutions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#layers" title="Layers" class="md-nav__link">
    Layers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-interface" title="User interface" class="md-nav__link">
    User interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observables-and-observemodelmixin" title="Observables and ObserveModelMixin" class="md-nav__link">
    Observables and ObserveModelMixin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#major-components-in-models" title="Major Components in Models" class="md-nav__link">
    Major Components in Models
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terria" title="Terria" class="md-nav__link">
    Terria
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalog" title="Catalog" class="md-nav__link">
    Catalog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nowviewing" title="NowViewing" class="md-nav__link">
    NowViewing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalogmember" title="CatalogMember" class="md-nav__link">
    CatalogMember
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cataloggroup" title="CatalogGroup" class="md-nav__link">
    CatalogGroup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalogitem" title="CatalogItem" class="md-nav__link">
    CatalogItem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalogfunction" title="CatalogFunction" class="md-nav__link">
    CatalogFunction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#globeormap" title="GlobeOrMap" class="md-nav__link">
    GlobeOrMap
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapping" title="Mapping" class="md-nav__link">
    Mapping
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-architecture" title="Build Architecture" class="md-nav__link">
    Build Architecture
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Architecture</h1>
                
                <p>TerriaJS is usually used in a single-page web application to provide mapping and catalog exploration capabilities.  It is written in ECMAScript (JavaScript) 2015+ and compiled to ECMAScript 5 in order to run in any relatively modern web browser, including Internet Explorer 9 or later.  Some features, such as 3D and vector tile region mapping, require more recent browsers, but TerriaJS can be expected to degrade gracefully in older browsers by disabling unsupported features or informing the user of the limitations of their browser. </p>
<h2 id="layers">Layers</h2>
<p>TerriaJS has a number of subdirectories of the <code>lib</code> directory, each of which corresponds to a conceptual layer in the design of TerriaJS.  The layers are:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>ThirdParty</td>
<td>This directory contains third-party code that is not available via npm packages for whatever reason.</td>
</tr>
<tr>
<td>Core</td>
<td>Low-level utility classes and functions that don't depend on a UI toolkit (i.e. React) or a mapping library (i.e. Cesium or Leaflet).</td>
</tr>
<tr>
<td>Map</td>
<td>Classes and functions to work with or extend a mapping library (i.e. Cesium or Leaflet). This layer should not depend on a particular UI toolkit (i.e. React).</td>
</tr>
<tr>
<td>Charts</td>
<td>Similar to the <code>Map</code> layer, except for charting instead of mapping.  This depends on the charting library (D3) but not on React.</td>
</tr>
<tr>
<td>Models</td>
<td>This is heart of TerriaJS.  Classes and functions in this layer know how to interface with catalog servers, map servers, and geospatial data formats.  Most of the logic of a TerriaJS application is found in this layer.  However, it does <em>not</em> depend on React.</td>
</tr>
<tr>
<td>ViewModels and ReactViewModels</td>
<td>Contains classes and functions that are closely associated with the UI but cannot be described as React components or views.  These two directories are separate mostly for historical reasons; there is little practical difference between them.</td>
</tr>
<tr>
<td>ReactViews</td>
<td>This is the React-based user interface of TerriaJS.  All of the React components are found in this layer.</td>
</tr>
</tbody>
</table>
<h2 id="user-interface">User interface</h2>
<p>TerriaJS uses the <a href="https://reactjs.org/">React</a> library as the basis for its user interface.  The top-level entry point is <a href="https://github.com/TerriaJS/terriajs/blob/master/lib/ReactViews/StandardUserInterface/StandardUserInterface.jsx">StandardUserInterface.jsx</a>.  It is expected that most applications will use this standard user interface, but a sophisticated TerriaJS application could use its own version instead in order to allow extreme customization of the interface.</p>
<p>For styling, we use <a href="http://sass-lang.com/">Sass</a> in CSS modules loaded via the Webpack <code>css-loader</code>, meaning that each React component imports its own local CSS styles from a <code>.scss</code> file.</p>
<p>The user interface is meant to be a thin layer with minimal domain-specific logic.  Ideally, all domain-specific logic would reside in the <code>Models</code> layer or perhaps in the <code>ViewModels</code> layer.  This approach allows the UI to be replaced (including by a user of TerriaJS rather than its developers) without needing to re-implement large chunks of TerriaJS logic.  In fact, the entire user interface can be viewed as optional.  A TerriaJS-based application could replace it with its own custom UI.</p>
<h2 id="observables-and-observemodelmixin">Observables and ObserveModelMixin</h2>
<p>Virtually all TerriaJS state is stored in instances of classes in the <code>Models</code> and <code>ViewModels</code> layers.  Many changes to this state are initiated by actions in the user interface.  For example, the user clicks an <code>Add to Map</code> button and a number of state changes take place that eventually cause the catalog item to appear on the map.</p>
<p>Some changes, however, come from elsewhere.  For example, when the user drags a JSON catalog file onto the map, this may cause any number of changes to objects in the <code>Models</code> layer.  In addition, the <code>Models</code> layer itself is usable as an API for TerriaJS.  Developers can add custom user interface components or other functionality that manipulate the objects in the <code>Models</code> layer.  It's important that the user interface update to reflect the new state, whether the state change was initiated by the core TerriaJS UI or not.</p>
<p>To that end, most of the properties of objects in the <code>Models</code> and <code>ViewModels</code> layers are observable.  Near the bottom of the constructor of most model objects (<a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/UrlTemplateCatalogItem.js">UrlTemplateCatalogItem</a> for example), you'll see a line like this:</p>
<pre><code>knockout.track(this, ['minimumLevel', 'maximumLevel', 'attribution', 'subdomains', 'tileDiscardPolicy']);
</code></pre>

<p><code>knockout.track</code> transforms each of the named properties on the given object (<code>this</code> in this case) into an observable property.  A Knockout observable property is just like a normal property; you can get and set its value as normal.  On top of that, however, an observable property raises an event when it changes.  For example, if we have a <code>UrlTemplateCatalogItem</code> instance in a variable named <code>urlTemplateCatalogItem</code>, we can subscribe to its <code>minimumLevel</code> property like this:</p>
<pre><code>knockout.getObservable(urlTemplateCatalogItem, 'minimumLevel').subscribe(function() {
    alert('minimumLevel changed!');
});
</code></pre>

<p>Many model classes also define computed properties, which are defined using either <code>overrideProperty</code> or <code>knockout.defineProperty</code>.  Computed properties have a getter and optionally a setter.  The getter is invoked once the first time the property is accessed and the value is memoized (cached).  Further accesses of the property will get the memoized value.</p>
<p>However, Knockout automatically keeps track of the set of observables (including other computed observables) that were accessed during the execution of the getter.  If any of <em>those</em> properties change, the computed observable's getter will be invoked again and the new value memoized.  This new invocation may access different observables properties than it did the first time around, and it is those new properties that will trigger any future re-evaluations of the computed property.  We can subscribe to change notification on computed properties in the same way we subscribe to regular observable properties.</p>
<p>It's rarely necessary to explicitly subscribe to an observable, though.  In the React components in the TerriaJS user interface, we use a React mix-in called <a href="https://github.com/TerriaJS/terriajs/blob/master/lib/ReactViews/ObserveModelMixin.js">ObserveModelMixin</a>.  When this mix-in is included in a component, the React <code>render</code> method acts a bit like a computed observable.  It automatically keeps track of all the observables that were read in the course of rendering the component.  If any of them change, the component will be automatically re-rendered.</p>
<p>With <code>ObserveModelMixin</code>, in most cases it's not necessary to think very much about the TerriaJS state when developing the UI.  Just write your <code>render</code> method as a pure function that produces virtual DOM nodes from the current state of the application, and rest assured that your <code>render</code> method will be called again if that state ever changes in a way that might affect what is shown to the user.</p>
<p>For more details of Knockout observables, see <a href="http://blog.stevensanderson.com/2013/05/20/knockout-es5-a-plugin-to-simplify-your-syntax/">Knockout-ES5</a> as well as the main <a href="http://knockoutjs.com/documentation/introduction.html">Knockout documentation</a>.</p>
<p>It may seem a bit stange that we're using Knockout, which is itself a user interface framework, in a library that uses React for its user interface.  In fact, we're not using the UI or DOM manipulation parts of Knockout at all.  We're only using it as an observable library.  Knockout's observables are feature rich and well tested, and make a great complement to React when paired with our <code>ObserveModelMixin</code>.</p>
<h2 id="major-components-in-models">Major Components in Models</h2>
<p>To help understand the code in Models, here is a summary of some of the major components of TerriaJS:</p>
<h3 id="terria"><a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/Terria.js">Terria</a></h3>
<p>The root of the TerriaJS application state. A TerriaJS-based application typically has only one <code>Terria</code> instance, though it is possible to have more in unusual situations.  All other objects can generally be found via this instance.</p>
<h3 id="catalog"><a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/Catalog.js">Catalog</a></h3>
<p>The TerriaJS catalog, built up from JSON init files as described in the <a href="../../customizing/">Customizing</a> section.  The <code>Catalog</code> is what you're looking at when you press the <code>Add data</code> button the UI.  It is accessible from the <code>catalog</code> property on the <code>Terria</code> instance.</p>
<h3 id="nowviewing"><a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/NowViewing.js">NowViewing</a></h3>
<p>Also known as the Workbench, this is shown in the panel on the left side of the UI, under the Add Data button.  This is the set of all enabled catalog items.  When the <code>isEnabled</code> property is set to true on a <code>CatalogItem</code>, it will appear here.  It is accessible from the <code>nowViewing</code> property on the <code>Terria</code> instance.</p>
<h3 id="catalogmember"><a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/CatalogMember.js">CatalogMember</a></h3>
<p>This is the base class for everything in the catalog, including <code>CatalogGroup</code>, <code>CatalogItem</code>, and <code>CatalogFunction</code>.</p>
<h3 id="cataloggroup"><a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/CatalogGroup.js">CatalogGroup</a></h3>
<p>A group of items in the catalog, shown as a folder in the UI.  The <code>CatalogGroup</code> class itself has a fixed set of items it holds, but derived classes can and do dynamically load their list of items from a remote server.  For a list of available catalog groups, see <a href="../../connecting-to-data/catalog-groups/">Catalog Groups</a>.</p>
<h3 id="catalogitem"><a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/CatalogItem.js">CatalogItem</a></h3>
<p>A catalog item can be enabled by settings its <code>isEnabled</code> property to <code>true</code>, at which point it appears in the Now Viewing / Workbench.  Usually an enabled catalog item also has a representation on the map and / or on the chart panel, though this is not strictly required.  For a list of available catalog items, see <a href="../../connecting-to-data/catalog-items/">Catalog Items</a>.</p>
<h3 id="catalogfunction"><a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/CatalogFunction.js">CatalogFunction</a></h3>
<p>Unlike a <code>CatalogItem</code>, a <code>CatalogFunction</code> cannot be directly enabled.  Instead, the user supplies parameters to the function and invokes it, and the result is a <code>CatalogItem</code> that is shown on the Workbench.  A Web Processing Service (WPS) is an excellent example of a <code>CatalogFunction</code>.  For a list of available catalog functions, see <a href="../../connecting-to-data/catalog-functions/">Catalog Functions</a>.</p>
<h3 id="globeormap"><a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/GlobeOrMap.js">GlobeOrMap</a></h3>
<p>The base class for a map view.  TerriaJS currently includes derived classes for a 3D view based on <a href="https://cesiumjs.org/">Cesium</a> (<a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/Cesium.js">Cesium</a> class) and a 2D view based on <a href="http://leafletjs.com/">Leaflet</a> (<a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Models/Leaflet.js">Leaflet</a> class).</p>
<h2 id="mapping">Mapping</h2>
<p>All mapping in TerriaJS happens through the abstractions provided by <a href="https://cesiumjs.org/">Cesium</a>.  Whether you're using the 3D Cesium view or the 2D Leaflet view, raster map layers are represented using Cesium's <a href="https://cesiumjs.org/Cesium/Build/Documentation/ImageryProvider.html">ImageryProvider</a> type and vector layers are represented using Cesium's <a href="https://cesiumjs.org/Cesium/Build/Documentation/DataSource.html">DataSource</a> and <a href="https://cesiumjs.org/Cesium/Build/Documentation/Entity.html">Entity</a> types.</p>
<p>Cesium's <a href="https://cesiumjs.org/tutorials/">tutorials</a> are a great introduction to these topics, especially the <a href="https://cesiumjs.org/tutorials/Imagery-Layers-Tutorial/">Imagery Layers</a> and <a href="https://cesiumjs.org/tutorials/Visualizing-Spatial-Data/">Visualizing Spatial Data</a> tutorials.</p>
<p>The code that renders these Cesium types on a Leaflet map is found in the <code>Map</code> layer, particularly <a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Map/CesiumTileLayer.js">CesiumTileLayer</a> and <a href="https://github.com/TerriaJS/terriajs/blob/master/lib/Map/LeafletVisualizer.js">LeafletVisualizer</a>.</p>
<p>In some specialized cases, such as <a href="http://localhost:3002/doc/guide/connecting-to-data/catalog-type-details/cesium-terrain/">CesiumTerrainCatalogItem</a>, catalog items directly interact with an underlying mapping engine rather than using the <code>ImageryProvider</code> and <code>DataSource</code> abstractions.</p>
<h2 id="build-architecture">Build Architecture</h2>
<p>TerriaJS and TerriaJS-based applications are built using <a href="https://webpack.js.org/">Webpack</a>.  A number of Webpack loaders are used to handle the various types of assets and transformations that TerriaJS requires.  An application that uses TerriaJS is expected to set up Webpack for its own needs and then call <a href="https://github.com/TerriaJS/terriajs/blob/master/buildprocess/configureWebpack.js">configureWebpack</a> to configure Webpack for TerriaJS.  <code>configureWebpack</code> takes care to avoid impacting Webpack configuration outside of TerriaJS itself.</p>
<p>It may be possible to build a TerriaJS application using a tool other than Webpack, such as Browserify or Rollup, but it is unlikely to be easy.  If you decide to attempt this, consider dropping by <a href="https://gitter.im/TerriaJS/terriajs">Gitter</a> or the <a href="https://groups.google.com/forum/#!forum/terriajs">TerriaJS forum</a>.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../development-environment/" title="Development Environment" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Development Environment
              </span>
            </div>
          </a>
        
        
          <a href="../using-a-custom-version-of-cesium/" title="Using a Custom Version of Cesium" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Using a Custom Version of Cesium
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.6cdc17f0.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>